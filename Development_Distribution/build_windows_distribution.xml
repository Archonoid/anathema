<?xml version="1.0" encoding="iso-8859-1"?>
<project name="Build Windows distribution" default="Distribute">

	<!--Target "Build Windows executable" runs on Windows only.-->
	<!--Requires the property "launch4j.dir" to point to the launch4j installation.-->
	<!--Requires the property "install4j.dir" to point to the install4j installation.-->
	<import file="common_distribution_targets.xml" />

	<property file="directories.properties" />

	<taskdef name="launch4j" classname="net.sf.launch4j.ant.Launch4jTask" classpath="${launch4j.dir}/launch4j.jar
	   :${launch4j.dir}/xstream.jar" />

	<taskdef name="install4j" classname="com.install4j.Install4JTask" classpath="${install4j.dir}\bin\ant.jar" />

	<target name="Distribute" depends="Build Bootloader, Build Plugins, Copy Text, Build Windows executable, Compile Installer" />

	<target name="Compile Installer">
		<property file="version.properties" />
		<property name="releaseVersion" value="${version.major}.${version.minor}" />
		<install4j projectfile="windows/install4j/Anathema.install4j" release="${releaseVersion}" destination="${basedir}"/>
	</target>

	<target name="Build Windows executable">
		<property file="version.properties" />
		<property name="versionString" value="${version.major}.${version.minor}.${version.revision}.0" />
		<property name="versionText" value="${versionString} ${version.name}" />
		<launch4j configFile="windows/launch4j.xml" outfile="${files.dir}/anathema.exe" fileVersion="${versionString}" productVersion="${versionString}" txtFileVersion="${versionText}" txtProductVersion="${versionText}" />
	</target>
</project>